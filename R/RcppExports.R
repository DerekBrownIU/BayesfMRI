# Generated by using Rcpp::compileAttributes() -> do not edit by hand
# Generator token: 10BE3573-1514-4C36-9D1C-5A225CD40393

#' Find the log of the determinant of Q_tilde
#'
#' @param kappa2 a scalar
#' @param in_list a list with elements Cmat, Gmat, and GtCinvG
#' @param n_sess the integer number of sessions
#' @export
logDetQt <- function(kappa2, in_list, n_sess) {
    .Call(`_BayesfMRI_logDetQt`, kappa2, in_list, n_sess)
}

#' Find the initial values of kappa2 and phi
#'
#' @param kappa2 a scalar scale parameter
#' @param phi a scalar range parameter
#' @param spde a list containing the sparse matrix elements Cmat, Gmat, and GtCinvG
#' @param w the beta_hat estimates for a single task
#' @param n_sess the number of sessions
#' @param tol the stopping rule tolerance
#' @export
initialKP <- function(kappa2, phi, spde, w, n_sess, tol) {
    .Call(`_BayesfMRI_initialKP`, kappa2, phi, spde, w, n_sess, tol)
}

#' Perform the EM algorithm of the Bayesian GLM fitting
#'
#' @param theta the vector of initial values for theta
#' @param spde a list containing the sparse matrix elements Cmat, Gmat, and GtCinvG
#' @param y the vector of response values
#' @param X the sparse matrix of the data values
#' @param QK a sparse matrix of the prior precision found using the initial values of the hyperparameters
#' @param Psi a sparse matrix representation of the basis function mapping the data locations to the mesh vertices
#' @param A a precomputed matrix crossprod(X%*%Psi)
#' @param Vh A random matrix with elements -1 and 1 used in the Hutchinson estimator of a trace
#' @param tol a value for the tolerance used for a stopping rule (compared to
#'   the squared norm of the differences between theta[s] and theta[s-1])
#' @export
findTheta <- function(theta, spde, y, X, QK, Psi, A, Vh, tol) {
    .Call(`_BayesfMRI_findTheta`, theta, spde, y, X, QK, Psi, A, Vh, tol)
}

